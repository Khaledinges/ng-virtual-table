!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/forms"),require("@angular/common"),require("@angular/cdk/scrolling"),require("@angular/platform-browser/animations"),require("@angular/material/icon"),require("@angular/material/form-field")):"function"==typeof define&&define.amd?define("ng-virtual-table",["exports","@angular/core","rxjs","rxjs/operators","@angular/forms","@angular/common","@angular/cdk/scrolling","@angular/platform-browser/animations","@angular/material/icon","@angular/material/form-field"],e):e(t["ng-virtual-table"]={},t.ng.core,t.rxjs,t.rxjs.operators,t.ng.forms,t.ng.common,t.ng.cdk.scrolling,t.ng.platformBrowser.animations,t.ng.material.icon,t.ng.material["form-field"])}(this,function(t,e,r,n,i,o,a,l,s,c){"use strict";var u=function(){return(u=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function f(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return a}var p=function(){function t(){this.itemCount=25,this.filterIsOpen=!1,this.filterPlaceholder="Filter",this.filterControl=new i.FormControl(""),this._headerDict=Object.create(null),this.column=[],this._dataStream=r.EMPTY,this.sort$=new r.Subject,this._destroyed$=new r.Subject,this._headerWasSet=!1,this.filter$=this.filterControl.valueChanges.pipe(n.debounceTime(350),n.startWith(null),n.distinctUntilChanged(),n.takeUntil(this._destroyed$))}return t.prototype.applySort=function(e){this.column=this.column.map(function(t){return t.key!==e?u({},t,{sort:null}):null===t.sort?u({},t,{sort:"asc"}):"asc"===t.sort?u({},t,{sort:"desc"}):"desc"===t.sort?u({},t,{sort:null}):void 0}),this.sort$.next(e)},t.prototype.ngOnChanges=function(t){var l=this;if("config"in t&&(this._config=t.config.currentValue,this.column=this.createColumnFromArray(this._config.column)),"dataSource"in t){var e=t.dataSource.currentValue;this._dataStream=r.combineLatest(this.sort$.asObservable().pipe(n.startWith(null)),this.filter$,e.pipe(n.tap(function(t){if(!l._headerWasSet){var e=new Set;t.forEach(function(t){return Object.keys(t).forEach(function(t){return e.add(t)})});var r=Array.from(e);l.column=l.createColumnFromArray(r)}}))).pipe(n.debounceTime(50),n.map(function(t){var e=f(t,3),r=e[0],n=e[1],i=e[2].slice(),o=l.column.find(function(t){return t.key===r});if(!r||!o)return[n,i];if(!o.sort)return[n,i];var a=l._headerDict[r];return"asc"===o.sort?i.sort(function(t,e){return l.getElement(t,a.func)>l.getElement(e,a.func)?1:l.getElement(t,a.func)===l.getElement(e,a.func)?0:-1}):i.sort(function(t,e){return l.getElement(t,a.func)<l.getElement(e,a.func)?1:l.getElement(t,a.func)===l.getElement(e,a.func)?0:-1}),[n,i]}),n.map(function(t){var e=f(t,2),r=e[0],n=e[1].slice();if(!r)return n;var i=r.toLocaleLowerCase(),o=n.filter(function(e){return l.column.some(function(t){return-1<l.getElement(e,t.func).toString().toLocaleLowerCase().indexOf(i)})});return console.log(o),o}),n.publishBehavior([]),n.refCount()),this.isEmptySubject$=this._dataStream.pipe(n.map(function(t){return!t.length}),n.tap(function(t){return console.log(t)}))}},t.prototype.createColumnFromArray=function(t){var r=this;if(t&&0!==t.length)return this._headerWasSet=!0,t.map(function(t){var e=r.createColumnFromConfigColumn(t);if(r._headerDict[e.key])throw Error("Column key="+e.key+" already declare");return r._headerDict[e.key]=e})},t.prototype.getElement=function(t,e){return e.call(this,t)},t.prototype.createColumnFromConfigColumn=function(e){if("string"==typeof e)return{name:e,key:e,func:function(t){return t[e]},sort:null};if(!e.key)throw Error("Column key for "+e+" must be exist");return{name:e.name||e.key,key:e.key,func:"function"==typeof e.func?e.func:function(t){return t[e.key]},sort:e.sort||null}},t.prototype.ngOnDestroy=function(){this._destroyed$.next()},t.prototype.clickItem=function(t){"function"==typeof this.onRowClick&&this.onRowClick(t)},t.prototype.toggleFilter=function(){var t=this;this.filterIsOpen=!this.filterIsOpen,this.filterIsOpen&&setTimeout(function(){t.inputFilterFocus.nativeElement.focus()}),this.filterControl.setValue("",{emitEvent:!this.filterIsOpen})},t.decorators=[{type:e.Component,args:[{selector:"ng-virtual-table",template:'<div class="table">\n  <div class="header">\n    <div *ngFor="let headerItem of column" class="header-item" (click)="applySort(headerItem.key)" [ngClass]="headerItem.sort">{{\n      headerItem.name\n      }}</div>\n    <div class="filter-spot" [ngClass]="[filterIsOpen ? \'open\' : \'\']">\n      <input #inputFilterFocus class="filter-spot-input" matInput [placeholder]="filterPlaceholder" [formControl]="filterControl">\n      <mat-icon (click)="toggleFilter()">{{ filterIsOpen ? \'close\' : \'filter_list\' }}</mat-icon>\n    </div>\n  </div>\n  <div class="virtual-table-content">\n    <cdk-virtual-scroll-viewport *ngIf="!(isEmptySubject$ | async); else emptyContainer" [itemSize]="itemCount">\n      <div *cdkVirtualFor="let item of _dataStream;templateCacheSize: 0" class="virtual-table-row" (click)="clickItem(item)">\n        <div *ngFor="let headerItem of column" class="virtual-table-column">{{\n          item[headerItem.name] }}</div>\n      </div>\n    </cdk-virtual-scroll-viewport>\n    <ng-template #emptyContainer>\n      Data is empty\n    </ng-template>\n  </div>\n</div>',changeDetection:e.ChangeDetectionStrategy.OnPush,styles:["@font-face{font-family:'Material Icons';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/materialicons/v41/flUhRq6tzZclQEJ-Vdg-IuiaDsNcIhQ8tQ.woff2) format(\"woff2\")}:host{display:block;position:relative}:host mat-icon::ng-deep{font-family:'Material Icons'}.table{height:100%;position:relative}.table .header{display:flex;margin-top:8px;height:40px;align-items:center;justify-content:space-between;border-bottom:1px solid #000}.table .header .filter-spot{display:flex;align-items:center;right:0;width:15px;min-width:15px;height:100%;position:relative}.table .header .filter-spot .filter-spot-input{display:none}.table .header .filter-spot mat-icon{cursor:pointer;margin-top:9px}.table .header .filter-spot.open mat-icon{z-index:1}.table .header .filter-spot.open .filter-spot-input{display:block;position:absolute;right:0}.table .header-item{cursor:pointer;display:flex;align-items:center;width:100%;height:100%;padding-left:16px}.table .header-item.asc:after{margin-right:4px;content:'arrow_downward';font-family:\"Material Icons\"}.table .header-item.desc:after{margin-right:4px;font-family:'Material Icons';content:'arrow_upward'}.table .virtual-table-content cdk-virtual-scroll-viewport::ng-deep{height:100%;width:100%}.table .virtual-table-content,.table .virtual-table-empty{display:flex;flex-direction:column;height:calc(100% - 40px)}.table .virtual-table-row{display:flex;flex-direction:row;min-height:20px;justify-content:space-between;align-items:center}.table .virtual-table-column{display:flex;width:100%;padding-left:16px;height:100%;align-items:center}"]}]}],t.propDecorators={inputFilterFocus:[{type:e.ViewChild,args:["inputFilterFocus"]}],dataSource:[{type:e.Input}],filterPlaceholder:[{type:e.Input}],config:[{type:e.Input}],onRowClick:[{type:e.Input}]},t}(),m=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[p],imports:[o.CommonModule,i.ReactiveFormsModule,l.BrowserAnimationsModule,s.MatIconModule,c.MatFormFieldModule,a.ScrollDispatchModule],exports:[p],providers:[]}]}],t}();t.NgVirtualTableModule=m,t.VirtualTableComponent=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng-virtual-table.umd.min.js.map