!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/forms"),require("@angular/common"),require("@angular/cdk/scrolling"),require("@angular/platform-browser/animations")):"function"==typeof define&&define.amd?define("ng-virtual-table",["exports","@angular/core","rxjs","rxjs/operators","@angular/forms","@angular/common","@angular/cdk/scrolling","@angular/platform-browser/animations"],t):t(e["ng-virtual-table"]={},e.ng.core,e.rxjs,e.rxjs.operators,e.ng.forms,e.ng.common,e.ng.cdk.scrolling,e.ng.platformBrowser.animations)}(this,function(e,t,r,n,o,a,i,l){"use strict";var s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(n=a.next()).done;)i.push(n.value)}catch(l){o={error:l}}finally{try{n&&!n.done&&(r=a["return"])&&r.call(a)}finally{if(o)throw o.error}}return i}var c=function(){function e(){this.itemCount=25,this.filterControl=new o.FormControl(""),this._headerColumn=new Set,this.column=[],this._dataStream=r.EMPTY,this.sort$=new r.Subject,this._destroyed$=new r.Subject,this._headerWasSet=!1,this.filter$=this.filterControl.valueChanges.pipe(n.debounceTime(300),n.startWith(null),n.distinctUntilChanged(),n.takeUntil(this._destroyed$))}return e.prototype.applySort=function(t){this.column=this.column.map(function(e){return e.name!==t?s({},e,{sort:null}):null===e.sort?s({},e,{sort:"asc"}):"asc"===e.sort?s({},e,{sort:"desc"}):"desc"===e.sort?s({},e,{sort:null}):void 0}),this.sort$.next(t)},e.prototype.ngOnChanges=function(e){var a=this;if("headerColumn"in e&&Array.isArray(e.headerColumn.currentValue)&&(this.column=this.createColumnFromArray(e.headerColumn.currentValue),this._headerWasSet=!0),"dataSource"in e){var t=e.dataSource.currentValue;this._dataStream=r.combineLatest(this.sort$.asObservable().pipe(n.startWith(null)),r.combineLatest(t.pipe(n.tap(function(e){a._headerWasSet||(a._headerColumn.clear(),e.forEach(function(e){return Object.keys(e).forEach(function(e){return a._headerColumn.add(e)})}),a.column=a.createColumnFromArray(Array.from(a._headerColumn)),a._headerWasSet=!0)}),n.map(function(e){return e.slice()})),this.filter$).pipe(n.map(function(e){var t=u(e,2),r=t[0],n=t[1],o=r.slice();if(!n)return o;var a=n.toLocaleLowerCase();return o.filter(function(t){return Object.keys(t).some(function(e){return t[e]&&-1<t[e].toString().toLocaleLowerCase().indexOf(a)})})}))).pipe(n.map(function(e){var t=u(e,2),r=t[0],n=t[1].slice(),o=a.column.find(function(e){return e.name===r});return r&&o&&o.sort&&("asc"===o.sort?n.sort(function(e,t){return e[o.name]>t[o.name]?1:e[o.name]===t[o.name]?0:-1}):n.sort(function(e,t){return e[o.name]<t[o.name]?1:e[o.name]===t[o.name]?0:-1})),n}),n.tap(function(e){return console.log(e)}))}},e.prototype.createColumnFromArray=function(e){return e.map(function(e){return{name:e,sort:null}})},e.prototype.ngOnDestroy=function(){this._destroyed$.next()},e.prototype.clickItem=function(e){"function"==typeof this.onRowClick&&this.onRowClick(e)},e.decorators=[{type:t.Component,args:[{selector:"ng-virtual-table",template:'<div class="table">\n  <div class="header">\n    <div *ngFor="let headerItem of column" class="header-item" (click)="applySort(headerItem.name)">{{ headerItem.name\n      }} {{ headerItem.sort }}</div>\n    <input type="text" [formControl]="filterControl">\n  </div>\n  <cdk-virtual-scroll-viewport [itemSize]="itemCount" class="virtual-table-content">\n    <div *cdkVirtualFor="let item of _dataStream;templateCacheSize: 0" class="virtual-table-row" (click)="clickItem(item)">\n      <div *ngFor="let headerItem of column" class="virtual-table-column">{{\n        item[headerItem.name] }}</div>\n    </div>\n  </cdk-virtual-scroll-viewport>\n</div>',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[":host{display:block;position:relative}.table{height:100%;position:relative}.table .header{display:flex;margin-top:8px;height:40px;align-items:center;border-bottom:1px solid #000}.table .header-item{cursor:pointer;margin:0 8px}.table .virtual-table-content,.table .virtual-table-empty{display:flex;flex-direction:column;height:calc(100% - 40px)}.table .virtual-table-row{display:flex;flex-direction:row;min-height:20px;margin:8px 0}.table .virtual-table-column{display:flex;margin:0 8px}"]}]}],e.propDecorators={dataSource:[{type:t.Input}],headerColumn:[{type:t.Input}],onRowClick:[{type:t.Input}]},e}(),m=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:[c],imports:[a.CommonModule,o.ReactiveFormsModule,l.BrowserAnimationsModule,i.ScrollDispatchModule],exports:[c],providers:[]}]}],e}();e.NgVirtualTableModule=m,e.VirtualTableComponent=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng-virtual-table.umd.min.js.map